{"remainingRequest":"/home/nicolas/Desktop/socket_io/client/node_modules/babel-loader/lib/index.js!/home/nicolas/Desktop/socket_io/client/node_modules/vue-loader-v16/dist/templateLoader.js??ref--6!/home/nicolas/Desktop/socket_io/client/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/nicolas/Desktop/socket_io/client/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/home/nicolas/Desktop/socket_io/client/src/components/ComponentCanvas.vue?vue&type=template&id=7425f435","dependencies":[{"path":"/home/nicolas/Desktop/socket_io/client/src/components/ComponentCanvas.vue","mtime":1616617271716},{"path":"/home/nicolas/Desktop/socket_io/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/nicolas/Desktop/socket_io/client/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/nicolas/Desktop/socket_io/client/node_modules/vue-loader-v16/dist/templateLoader.js","mtime":499162500000},{"path":"/home/nicolas/Desktop/socket_io/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/nicolas/Desktop/socket_io/client/node_modules/vue-loader-v16/dist/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgY3JlYXRlVk5vZGUgYXMgX2NyZWF0ZVZOb2RlLCBvcGVuQmxvY2sgYXMgX29wZW5CbG9jaywgY3JlYXRlQmxvY2sgYXMgX2NyZWF0ZUJsb2NrIH0gZnJvbSAidnVlIjsKdmFyIF9ob2lzdGVkXzEgPSB7CiAgd2lkdGg6ICIzMjAiLAogIGhlaWdodDogIjMyMCIKfTsKZXhwb3J0IGZ1bmN0aW9uIHJlbmRlcihfY3R4LCBfY2FjaGUsICRwcm9wcywgJHNldHVwLCAkZGF0YSwgJG9wdGlvbnMpIHsKICByZXR1cm4gX29wZW5CbG9jaygpLCBfY3JlYXRlQmxvY2soImNhbnZhcyIsIF9ob2lzdGVkXzEsICIgQ2FudmFzIG5vdCBzdXBwb3J0ZWQgIik7Cn0="},{"version":3,"sources":["/home/nicolas/Desktop/socket_io/client/src/components/ComponentCanvas.vue"],"names":[],"mappings":";;AACY,EAAA,KAAK,EAAC,K;AAAM,EAAA,MAAM,EAAC;;;uBAA3B,YAAA,CAES,QAFT,EAAA,UAAA,EAAiC,wBAAjC,C","sourcesContent":["<template>\n    <canvas width=\"320\" height=\"320\">\n        Canvas not supported\n    </canvas>\n</template>\n\n<script>\n    import io from \"socket.io-client\"\n    import {Entity, EntityListDict} from \"../scripts/Entity.js\"\n\n    export default {\n        name: 'ComponentCanvas',\n        data (){\n            return {\n                socket: {},\n                player: {},\n                enemy:  {},\n                turn: 0,\n            }\n        },\n        created() {\n            this.socket = io(\"http://localhost:3000\", {transports:['websocket']});\n        },\n        mounted() {\n\n\n            this.socket.on('connect', () => {\n                const playerId = this.socket.id\n                console.log(\"> Connected to Server: \", playerId);\n\n\n                var canvas = document.querySelector('canvas');\n                var context = canvas.getContext('2d');\n\n                var entityList = new EntityListDict();\n\n                entityList.print()\n\n                var sprite_char = new Image();\n                sprite_char.src = require('../assets/idle.png');\n\n                // var background = new Image();\n                // background.src = require('../assets/map.png');\n                \n\n\n                // var game_world  = new Entity(null, 0, 0, 595, 595, background, {x:0, y:0});\n                var game_world;\n\n\n                // sprite\n                // entityList.add(game_world)\n\n                var that = this\n                window.addEventListener('keydown', function(e){\n                    var keyPressed = e.key;\n\n                    const command = {\n                        type: 'move-player',\n                        playerId: playerId,\n                        keyPressed\n                    }\n\n                    that.socket.emit('move-player', command);\n\n                }, false);\n\n    \n\n                function loop(){\n                    window.requestAnimationFrame(loop, canvas);\n                    render();\n                }\n\n\n                this.socket.on('setup', (command) => {\n                    var background = new Image()\n                    background.src = require(\"../assets/map.png\");\n\n                    game_world  = new Entity(null, 0, 0, command.scenario.image.width, command.scenario.image.height, background, {x:0, y:0});\n\n                    Object.keys(command.players).forEach(function(key) {\n                        entityList.add(new Entity(key, command.players[key].x, command.players[key].y, 16, 16, sprite_char, command.players[key].cam))\n                    });\n\n                })\n\n\n                this.socket.on('move-player', (command) => {\n                    console.log(command)\n                    updateSpecificPlayer(command.playerId, command.position, command.cam)\n                });\n\n\n                this.socket.on('add-player', (command) => {\n                    entityList.add(new Entity(command.playerId, command.position.x, command.position.y, 16, 16, sprite_char, command.cam))\n                });\n\n                this.socket.on('remove-player', (command) => {\n                    console.log(\"> Removing Player \", command.playerId);\n                    entityList.remove(command.playerId)\n                });\n\n\n                function updateSpecificPlayer(playerId, position, cam){\n                    entityList.entities.players[playerId].x = position.x;\n                    entityList.entities.players[playerId].y = position.y;\n\n                    entityList.entities.players[playerId].cam.x = cam.x;\n                    entityList.entities.players[playerId].cam.y = cam.y;\n                }\n\n\n\n                function render()\n                {\n                    context.save();\n\n                    var playerCam = entityList.entities.players[playerId].cam;\n                    context.translate(-playerCam.x, -playerCam.y);\n\n                    // console.log(entityList.entities.players)\n\n                    context.drawImage(game_world.sprite, 0, 0);   \n\n                    for (const [key, value] of Object.entries(entityList.entities.players)) {\n                        context.drawImage(value.sprite, 0, 0, value.width, value.height, value.x, value.y, value.width, value.height);   \n                    }\n\n                    context.restore();\n                }\n\n                loop()\n            });\n\n\n\n\n        }\n\n    }\n</script>\n\n<style scoped></style>\n"],"sourceRoot":""}]}